[2025-08-10 20:47:37,225][src.llama_lora.utils.common][INFO] - Configuration Summary:
[2025-08-10 20:47:37,226][src.llama_lora.utils.common][INFO] - ==================================================
[2025-08-10 20:47:37,226][src.llama_lora.utils.common][INFO] - Model: microsoft/DialoGPT-small
[2025-08-10 20:47:37,226][src.llama_lora.utils.common][INFO] - Use DoRA: False
[2025-08-10 20:47:37,226][src.llama_lora.utils.common][INFO] - Dataset: tatsu-lab/alpaca (train)
[2025-08-10 20:47:37,226][src.llama_lora.utils.common][INFO] - Learning Rate: 2e-05
[2025-08-10 20:47:37,226][src.llama_lora.utils.common][INFO] - Batch Size: 4
[2025-08-10 20:47:37,226][src.llama_lora.utils.common][INFO] - Epochs: 1
[2025-08-10 20:47:37,226][src.llama_lora.utils.common][INFO] - LoRA Rank: 16
[2025-08-10 20:47:37,226][src.llama_lora.utils.common][INFO] - Output Dir: ./output
[2025-08-10 20:47:37,226][src.llama_lora.utils.common][INFO] - ==================================================
[2025-08-10 20:47:37,226][src.llama_lora.utils.common][INFO] - Configuration validation successful!
[2025-08-10 20:47:37,239][src.llama_lora.utils.common][INFO] - Using device: mps
[2025-08-10 20:47:37,241][src.llama_lora.utils.common][INFO] - Loading tokenizer from 'microsoft/DialoGPT-small'...
[2025-08-10 20:47:40,226][src.llama_lora.utils.common][INFO] - Loading dataset tatsu-lab/alpaca...
[2025-08-10 20:47:43,684][src.llama_lora.utils.common][INFO] - Processing dataset...
[2025-08-10 20:47:47,909][src.llama_lora.utils.common][INFO] - Splitting dataset...
[2025-08-10 20:47:47,922][src.llama_lora.utils.common][INFO] - Dataset loaded: 49401 train, 2601 eval samples
[2025-08-10 20:47:47,922][src.llama_lora.utils.common][INFO] - Loading base model 'microsoft/DialoGPT-small'...
[2025-08-10 20:48:03,754][src.llama_lora.utils.common][INFO] - Setting up PEFT with LoRA/DoRA...
[2025-08-10 20:48:03,757][src.llama_lora.utils.common][ERROR] - Training failed: Failed to load or setup model: Target modules ['q_proj', 'v_proj'] not found in the base model. Please check the target modules and try again.
Traceback (most recent call last):
  File "/Users/s23736/Documents/001_develop/002_products/003_personal/llama-lora/src/llama_lora/train.py", line 205, in load_and_setup_model
    model = get_peft_model(model, peft_config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/s23736/Documents/001_develop/002_products/003_personal/llama-lora/.venv/lib/python3.12/site-packages/peft/mapping_func.py", line 125, in get_peft_model
    return MODEL_TYPE_TO_PEFT_MODEL_MAPPING[peft_config.task_type](
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/s23736/Documents/001_develop/002_products/003_personal/llama-lora/.venv/lib/python3.12/site-packages/peft/peft_model.py", line 1815, in __init__
    super().__init__(model, peft_config, adapter_name, **kwargs)
  File "/Users/s23736/Documents/001_develop/002_products/003_personal/llama-lora/.venv/lib/python3.12/site-packages/peft/peft_model.py", line 130, in __init__
    self.base_model = cls(model, {adapter_name: peft_config}, adapter_name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/s23736/Documents/001_develop/002_products/003_personal/llama-lora/.venv/lib/python3.12/site-packages/peft/tuners/tuners_utils.py", line 209, in __init__
    self.inject_adapter(self.model, adapter_name, low_cpu_mem_usage=low_cpu_mem_usage, state_dict=state_dict)
  File "/Users/s23736/Documents/001_develop/002_products/003_personal/llama-lora/.venv/lib/python3.12/site-packages/peft/tuners/tuners_utils.py", line 654, in inject_adapter
    raise ValueError(error_msg)
ValueError: Target modules ['q_proj', 'v_proj'] not found in the base model. Please check the target modules and try again.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/s23736/Documents/001_develop/002_products/003_personal/llama-lora/src/llama_lora/train.py", line 316, in main
    model = load_and_setup_model(cfg)
            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/s23736/Documents/001_develop/002_products/003_personal/llama-lora/src/llama_lora/train.py", line 212, in load_and_setup_model
    raise ModelLoadingError(f"Failed to load or setup model: {str(e)}") from e
src.llama_lora.utils.exceptions.ModelLoadingError: Failed to load or setup model: Target modules ['q_proj', 'v_proj'] not found in the base model. Please check the target modules and try again.
